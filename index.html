
<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <title>¬øQu√© hay de nuevo en Python 3.11?</title>
    <link rel="stylesheet" type="text/css" href="_static/revealjs4/dist/reveal.css" />
    <link rel="stylesheet" href="_static/revealjs4/dist/theme/.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/theme.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=M+PLUS+1p&amp;display=swap" type="text/css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/translations.js"></script>
    <script src="_static/main.js"></script>
    <link rel="index" title="√çndice" href="genindex.html" />
    <link rel="search" title="B√∫squeda" href="search.html" />
    <link rel="next" title="¬øQu√© hay de nuevo en Python 3.11?" href="README.html" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    
    <style>
      .reveal *, .reveal h1, .reveal h2, .reveal h3, .reveal h4, .reveal h5, .reveal h6 {
        font-family: 'M PLUS 1p', sans-serif;
      }
    </style>
    

  </head><body>
    <div class="reveal">
        <div class="slides" role="main">
            <div class="toctree-wrapper compound">
</div>
<section data-transition="zoom" id="intro">
<h1>¬øQu√© hay de nuevo en <strong>Python 3.11</strong>?</h1>
<a class="reference internal image-reference" href="_images/python-logo.png"><img alt="_images/python-logo.png" src="_images/python-logo.png" style="width: 200px;" /></a>
<aside class="notes">
Hola a todos.</aside>
</section>
<section>
<section  id="id1">
<h2>üëã</h2>
<aside class="notes">
Hac√≠a mucho que no nos reun√≠amos para celebrar un meetup Python M√°laga.</aside>
</section>
<section data-transition="convex" id="marzo-2020">
<h3>Marzo 2020</h3>
<aside class="notes">
La √∫ltima vez fue el 4 de marzo de 2020. Mes que muchos recordar√©is.</aside>
</section>
<section  id="estamos-de-vuelta">
<h3>Estamos de vuelta</h3>
<pre data-id="estamos-de-vuelta"><code data-trim data-noescape class="python">&gt;&gt;&gt; import datetime
&gt;&gt;&gt; import humanize
&gt;&gt;&gt; delta = datetime.datetime(2022, 10, 27) - datetime.datetime(2020, 3, 4)
&gt;&gt;&gt; humanize.i18n.activate(&quot;es_ES&quot;)
&gt;&gt;&gt; print(repr(humanize.precisedelta(delta)))
&quot;2 a√±os, 7 meses y 23 d√≠as&quot;</code></pre>
<aside class="notes">
Pero ya estamos aqu√≠. 2 a√±os, 7 meses y 23 d√≠as despu√©s.</aside>
</section>
<section  id="python-malaga">
<h3>Python <strong>M√°laga</strong></h3>
<img alt="_images/python-malaga-logo.png" src="_images/python-malaga-logo.png" />
<aside class="notes">
Y quiero agradecer tanto a Python M√°laga como a Codespace por cedernos este espacio, por la oportunidad de estar
aqu√≠ todos juntos de nuevo. Gracias.</aside>
</section>
<section data-transition="concave" id="sobre-mi">
<h3>Sobre m√≠ <strong>Nekmo</strong></h3>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="_images/cara.svg"><img alt="_images/cara.svg" src="_images/cara.svg" width="200px" /></a>
<p><em>Programando en Python desde 2006</em></p>
</td>
</tr>
</tbody>
</table>
<aside class="notes">
Pero bueno, dejad de que me presente. Soy Juan Jos√©, m√°s conocido en redes como Nekmo, y llevo programando en
Python m√°s de media vida.</aside>
</section>
<section  id="python-2-5">
<h3>Python <strong>2.5</strong></h3>
<aside class="notes">
Mi primera versi√≥n de Python fue la 2.5. Han pasado ya muchos a√±os, y con cada nueva versi√≥n no
dejan de traer novedades.</aside>
</section>
</section>
<section>
<section  id="id2">
<h2>¬øQu√© hay de nuevo en <strong>Python 3.11</strong>?</h2>
<aside class="notes">
Ahora, ¬øqu√© hay de nuevo en Python 3.11?</aside>
</section>
<section data-transition="zoom" id="listado-de-cambios">
<h3>Listado  de cambios</h3>
<ul class="simple">
<li><p><strong>PEP 654:</strong> Exception Groups y except*.</p></li>
<li><p><strong>PEP 678:</strong> Enriquecer excepciones con notas.</p></li>
<li><p><strong>PEP 680:</strong> tomllib.</p></li>
<li><p><strong>PEP 657:</strong> Mejoras en las indicaciones de error en los tracebacks.</p></li>
<li><p>Opci√≥n <code class="docutils literal notranslate"><span class="pre">-P</span></code> en la l√≠nea de comandos y variable de entorno <code class="docutils literal notranslate"><span class="pre">PYTHONSAFEPATH</span></code>.</p></li>
<li><p><strong>PEP 646:</strong> Variadic Generics.</p></li>
<li><p><strong>PEP 655:</strong> TypedDict Required/NotRequired.</p></li>
<li><p><strong>PEP 673:</strong> Tipo Self.</p></li>
<li><p><strong>PEP 675:</strong> Tipo de cadena literal arbitraria</p></li>
<li><p><strong>PEP 681:</strong> Data Class Transforms</p></li>
<li><p>M√≥dulos obsoletos (PEP 594),  Py_UNICODE API eliminada (PEP 624) y macros convertidas a funciones est√°ticas en l√≠nea
(PEP 670).</p></li>
</ul>
<aside class="notes">
Pues este ser√≠a el listado de todos los cambios, los cuales se pueden consultar en la web oficial de Python.
El m√°s importante son los exception groups para agrupar excepciones, mejoras en los tracebacks, el nuevo m√≥dulo
tomllib y novedades en el tipado.</aside>
</section>
<section  id="gracias">
<h3>Gracias</h3>
<aside class="notes">
Y hasta aqu√≠ la charla. Muchas gracias a todos por venir. (PAUSA) Ahora en serio, vamos a ir viendo cada uno de
estos cambios, aunque me tendr√© que detener bastante en el primero de ellos porque es el m√°s importante y m√°s
interesante.</aside>
</section>
</section>
<section>
<section  id="pep-654-exception-groups-y-except">
<h2><strong>PEP 654:</strong> Exception Groups y except*</h2>
<aside class="notes">
La primera de estas novedades son los exception groups y el nuevo except* con asterisco, con PEP 654.</aside>
</section>
<section >
<pre data-id="pep-654-exception-groups-y-except"><code data-trim data-noescape class="python" data-line-numbers="1-2,7,12|11-14|5-7|13-14"> class NameError(Exception):
     pass


 def validate_name(value: str) -&gt; None:
     if not value.istitle():
         raise NameError(&quot;El nombre debe empezar por may√∫scula.&quot;)


 form = {&quot;name&quot;: &quot;nekmo&quot;}
 try:
     validate_name(form[&quot;name&quot;])
 except NameError as err:
     print(err)  # Salta el error</code></pre>
<aside class="notes">
Aqu√≠ tenemos una excepci√≥n tradicional de Python, a lo cual lo normal es lanzar una √∫nica excepci√≥n (1) y
capturarla (2). En la funci√≥n validamos la entrada, y si no valida se lanza una excepci√≥n (3),
la cual se captura en el except y se muestra por pantalla (4).</aside>
</section>
<section data-transition="zoom">
<img alt="_images/validacion-formulario.png" src="_images/validacion-formulario.png" />
<aside class="notes">
Pero en nuestro caso tenemos un formulario. Un formulario en el que nuestro usuario comete varios errores, y
queremos mostrarle al usuario todos los errores de golpe, no excepci√≥n por excepci√≥n. Necesitamos agruparlos.</aside>
</section>
<section >
<pre data-id="pep-654-exception-groups-y-except"><code data-trim data-noescape class="python" data-line-numbers="13,17|8-10,14,19|21|22-23"> from typing import Iterable, Tuple, Dict, Callable


 class NumberError(Exception):
     pass


 def validate_age(value: str) -&gt; None:
     if not value.isdigit():
         raise NumberError(&quot;La edad debe ser un valor num√©rico.&quot;)


 form = {&quot;name&quot;: &quot;nekmo&quot;, &quot;age&quot;: &quot;diez&quot;}
 form_validations = [(&quot;name&quot;, validate_name), (&quot;age&quot;, validate_age)]
 exceptions = []

 for form_key, input_validation in input_validations:
     try:
         input_validation(form[form_key])
     except Exception as err:
         exceptions.append(value)
 if exceptions:
     raise ExceptionGroup(&quot;errors message&quot;, exceptions)</code></pre>
<aside class="notes">
En este segundo ejemplo iteramos sobre todos los valores del formulario (1), aplicamos su validaci√≥n (2) y si hay un
error lo a√±adimos al listado de excepciones (3). Si hay errores lanzamos el ExceptionGroup con sus exceptions (4).</aside>
</section>
<section >
<img alt="_images/json.png" src="_images/json.png" />
<aside class="notes">
Esto como os imaginar√©is es muy √∫til en casos como un JSON, o cuando nos vienen varios datos de entrada a validar,
como en el ejemplo del formulario. Pero claro, os estar√©is preguntando. ¬øPara qu√© esto si s√≥lo es crear un listado
de excepciones con un nuevo tipo de excepci√≥n?</aside>
</section>
<section  id="except">
<h3>except*</h3>
<aside class="notes">
La verdadera novedad  comienza usando el nuevo except con asterisco.</aside>
</section>
<section >
<pre data-id="except"><code data-trim data-noescape class="python" data-line-numbers="1-8|3-5|6-8"> try:
     read_inputs()
 except* NameError as eg:
     # Si hay errores NameError esto se llama
     print(f&quot;Errores en el nombre: {eg.exceptions}&quot;)
 except* NumberError as eg:
     # Y si hay errores NumberError, esto tambi√©n
     print(f&quot;Errores num√©ricos: {eg.exceptions}&quot;)</code></pre>
<aside class="notes">
Podemos utilizarlo para capturar m√∫ltiples exceptiones agrupadas diferenciadas por tipo. Y lo que es mejor, a
diferencia de lo habital que es que el except no contin√∫e ante la primera coincidencia, con el except con aster√≠sco
s√≠ que sigue. (LEER EJEMPLO).</aside>
</section>
<section >
<pre data-id="except"><code data-trim data-noescape class="python">raise ExceptionGroup(&quot;nested&quot;,
    [
         ValueError(654),
         ExceptionGroup(&quot;imports&quot;,
             [
                 ImportError(&quot;no_such_module&quot;),
                 ModuleNotFoundError(&quot;another_module&quot;),
             ]
         ),
         TypeError(&quot;int&quot;),
     ]</code></pre>
<aside class="notes">
Por si fuese poco, tambi√©n podemos meter excepciones dentro de otras. Esto es especialmente √∫til en casos como un
JSON, en que tenemos m√∫ltiples niveles. Tambi√©n es √∫til en ejecuci√≥n as√≠ncrona, en que varias funciones lanzan a
su vez varias excepciones. Justamente algo similar al ExceptionGroup lo ten√≠a Trio con el MultiError,
aunque ahora lo tenemos de serie.</aside>
</section>
</section>
<section data-background-color="#000000" data-background-image="_static/applause.gif" id="continuamos">
<h2>¬°Continuamos!</h2>
<aside class="notes">
No os preocup√©is, esto era lo gordo. Lo que viene son cambios m√°s peque√±os, pero muchos muy interesantes.</aside>
</section>
<section  id="pep-678-enriquecer-excepciones-con-notas">
<h2><strong>PEP 678:</strong> Enriquecer excepciones con notas</h2>
<aside class="notes">
Y seguimos con excepciones. El nuevo m√©todo PEP 678 permite a√±adir notas, aclaraciones, a las excepciones que se
lanzan.</aside>
</section>
<section >
<pre data-id="pep-678-enriquecer-excepciones-con-notas"><code data-trim data-noescape class="python" data-line-numbers="2|3|4|5"> try:
      raise TypeError('bad type')
 except Exception as e:
      e.add_note('¬°Ah, ah, ah! ¬°No has dicho la palabra m√°gica!')
      raise</code></pre>
<aside class="notes">
En este ejemplo se produce una excepci√≥n (1), se captura (2), se le a√±ade una nota usando el nuevo m√©todo add_note
disponible en Exception (3), y se vuelve a lanzar ya con la nota (4).</aside>
</section>
<section >
<pre data-id="pep-678-enriquecer-excepciones-con-notas"><code data-trim data-noescape class="python" data-line-numbers="1-4|4"> Traceback (most recent call last):
   File &quot;&lt;stdin&gt;&quot;, line 2, in &lt;module&gt;
 TypeError: bad type
 ¬°Ah, ah, ah! ¬°No has dicho la palabra m√°gica!</code></pre>
<aside class="notes">
Y cuando se produce la excepci√≥n, la nota es mostrada en una segunda l√≠nea. As√≠ se simple. Genial para aclaraciones y
otras anotaciones.</aside>
</section>
<section >
<pre data-id="pep-678-enriquecer-excepciones-con-notas"><code data-trim data-noescape class="python">+ Exception Group Traceback (most recent call last):
|   File &quot;test.py&quot;, line 4, in test
|     def test(x):
|
|   File &quot;hypothesis/core.py&quot;, line 1202, in wrapped_test
|     raise the_error_hypothesis_found
|     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
| ExceptionGroup: Hypothesis found 2 distinct failures.
+-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File &quot;test.py&quot;, line 6, in test
    |     assert x &gt; 0
    |     ^^^^^^^^^^^^
    | AssertionError: assert -1 &gt; 0
    |
    | Falsifying example: test(
    |     x=-1,
    | )
    +---------------- 2 ----------------
    | Traceback (most recent call last):
    |   File &quot;test.py&quot;, line 5, in test
    |     assert x &lt; 0
    |     ^^^^^^^^^^^^
    | AssertionError: assert 0 &lt; 0
    |
    | Falsifying example: test(
    |     x=0,
    | )
    +------------------------------------</code></pre>
<aside class="notes">
Y por supuesto, esto tambi√©n puede utilizarse con los ExceptionGroup - Ya veis lo que me gustan - de forma que
a√±adimos informaci√≥n adicional sobre la parte del exception group en que ha sucedido. Y de paso, ¬°ahora pod√©is
conseguir que vuestros tracebacks den miedo! Como este de aqu√≠.</aside>
</section>
<section  id="pep-657-mejoras-en-las-indicaciones-de-error-en-los-tracebacks">
<h2><strong>PEP 657:</strong> Mejoras en las indicaciones de error en los tracebacks</h2>
<aside class="notes">
Y seguimos con tracebacks de error. Vamos a ver las mejoras que se han hecho en los mensaje de traceback.</aside>
</section>
<section data-auto-animate>
<pre data-id="pep-657-mejoras-en-las-indicaciones-de-error-en-los-tracebacks"><code data-trim data-noescape class="python" data-line-numbers="5-6"> Traceback (most recent call last):
   File &quot;distance.py&quot;, line 11, in &lt;module&gt;
     print(manhattan_distance(p1, p2))
   File &quot;distance.py&quot;, line 6, in manhattan_distance
     return abs(point_1.x - point_2.x) + abs(point_1.y - point_2.y)
 AttributeError: 'NoneType' object has no attribute 'x'</code></pre>
<aside class="notes">
Hasta ahora en Python, como recordar√©is, lo habitual cuando hay varias variables en una sola l√≠nea y una de ellas es
None, la √∫nica forma de encontrar la que provocaba el error era ponerse a depurar, porque el error no da bastante
informaci√≥n.</aside>
</section>
<section data-auto-animate>
<pre data-id="pep-657-mejoras-en-las-indicaciones-de-error-en-los-tracebacks"><code data-trim data-noescape class="python" data-line-numbers="4,6-8"> Traceback (most recent call last):
   File &quot;distance.py&quot;, line 11, in &lt;module&gt;
     print(manhattan_distance(p1, p2))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
   File &quot;distance.py&quot;, line 6, in manhattan_distance
     return abs(point_1.x - point_2.x) + abs(point_1.y - point_2.y)
                            ^^^^^^^^^
 AttributeError: 'NoneType' object has no attribute 'x'</code></pre>
<aside class="notes">
Pero ahora con Python 3.11, ¬°ya no hace falta depurar! Porque ahora tienes flechitas que te indican lo que es un
None. Y no hay nada m√°s f√°cil que seguir flechitas que indican lo que tienes que arreglar, ¬øno?</aside>
</section>
<section >
<pre data-id="pep-657-mejoras-en-las-indicaciones-de-error-en-los-tracebacks"><code data-trim data-noescape class="python" data-line-numbers="11-13"> Traceback (most recent call last):
   File &quot;query.py&quot;, line 37, in &lt;module&gt;
     magic_arithmetic('foo')
   File &quot;query.py&quot;, line 18, in magic_arithmetic
     return add_counts(x) / 25
            ^^^^^^^^^^^^^
   File &quot;query.py&quot;, line 24, in add_counts
     return 25 + query_user(user1) + query_user(user2)
                 ^^^^^^^^^^^^^^^^^
   File &quot;query.py&quot;, line 32, in query_user
     return 1 + query_count(db, response['a']['b']['c']['user'], retry=True)
                                ~~~~~~~~~~~~~~~~~~^^^^^
 TypeError: 'NoneType' object is not subscriptable</code></pre>
<aside class="notes">
Y el caso en que esto me ha parecido m√°s √∫til es accediendo a diccionarios. Seguro que os ha pasado alguna vez
acceder a un diccionario dentro de otro dentro de otro, y que a partir de cierto punto sea un None y no saber en
qu√© nivel ocurre. Pues ahora se te indica. Con flechitas. ¬øQu√© m√°s podemos pedir?</aside>
</section>
<section>
<section  id="pep-680-tomllib">
<h2><strong>PEP 680:</strong> Tomllib</h2>
<aside class="notes">
Y ahora, algo completamente diferente. Tenemos un nuevo m√≥dulo en la biblioteca est√°ndar, Tomlib. ¬øPero qu√© significa
TOML?</aside>
</section>
<section  id="tom-s-obvious-minimal-language">
<h3>Tom's Obvious, Minimal Language</h3>
<aside class="notes">
Pues obviamente, Tom's Obvious Minimal Language. ¬øY por qu√© Tom?</aside>
</section>
<section >
<img alt="_images/tom.png" src="_images/tom.png" />
<aside class="notes">
Algunos ya os lo habr√©is imaginado, pero es como se llama el creador de este lenguaje. Un poco egoc√©ntrico pensar√©is.
Pero si le veis tan feliz es por una buena raz√≥n: es el fundador de Github, ahora millonario.</aside>
</section>
<section >
<pre data-id="tom-s-obvious-minimal-language"><code data-trim data-noescape class="toml"># This is a TOML document

title = &quot;TOML Example&quot;

[owner]
name = &quot;Tom Preston-Werner&quot;
dob = 1979-05-27T07:32:00-08:00

[database]
enabled = true
ports = [ 8000, 8001, 8002 ]
data = [ [&quot;delta&quot;, &quot;phi&quot;], [3.14] ]
temp_targets = { cpu = 79.5, case = 72.0 }

[servers]

[servers.alpha]
ip = &quot;10.0.0.1&quot;
role = &quot;frontend&quot;</code></pre>
<aside class="notes">
Pero vayamos a lo que nos importa. Toml es un formato de archivo de configuraci√≥n sencillo de entender y de editar
por un humano, a diferencia de JSON. Solventa algunos de los problemas de Yaml como su falta de consistencia y
ofrece m√°s caracter√≠sticas que los ficheros ini en los que se basa.</aside>
</section>
<section >
<pre data-id="tom-s-obvious-minimal-language"><code data-trim data-noescape class="python">import tomllib


with open(&quot;fichero.toml&quot;) as f:
    tomllib.load(f)</code></pre>
<aside class="notes">
Leer un fichero toml es muy sencillo, muy similar a como se hace con el m√≥dulo de json. No obstante, curiosamente
no disponemos de un m√©todo de hacer un dump, por lo que no podemos escribir.</aside>
</section>
</section>
<section  id="novedades-en-el-tipado">
<h2>Novedades en el <strong>tipado</strong></h2>
<aside class="notes">
Y ahora, llega la secci√≥n favorita para los **tipos** que les gustan los *tipos*.</aside>
</section>
<section >
<img alt="_images/badum.png" src="_images/badum.png" />
<aside class="notes">
No me lo teng√°is en cuenta, por favor.</aside>
</section>
<section  id="pep-646-variadic-generics">
<h2><strong>PEP 646:</strong> Variadic Generics</h2>
<aside class="notes">
Comenzamos con una novedad en el tipado de los generics, que nos permite tener tipados de salida en los m√©todos en
funci√≥n de c√≥mo se defina para nuestra clase. Esta caracter√≠stica es interesante para m√≥dulos como TensorFlow, aunque
para el p√∫blico general tiene pocos usos.</aside>
</section>
<section >
<pre data-id="pep-646-variadic-generics"><code data-trim data-noescape class="python" data-line-numbers="9-14|5,18|10-11,18-19|13-14,18,21|1-21"> from typing import Tuple, Generic, TypeVarTuple, TypeVar


 T = TypeVar('T')
 Ts = TypeVarTuple('Ts')  # Esta es la novedad


 # Aqu√≠ usamos el TypeVarTuple como definici√≥n para el tipo
 class Array(Generic[*Ts]):
     def multiply(self, x: int) -&gt; Tuple[*Ts]:  # Y aqu√≠ como return
         ...

     def add_dimension(self, t: T) -&gt; Tuple[T, *Ts]:
         ...


 # Ts en este caso ser√° [float, int, str]
 my_array: Array[float, int, str] = Array()
 my_array.multiply(2)  # El tipo devuelto ser√° Tuple[float, int, str]
 # El tipo devuelto ser√° Tuple[str, float, int, str]
 my_array.add_dimension(&quot;spam&quot;)</code></pre>
<aside class="notes">
Bien, aqu√≠ tenemos nuestra propia clase Array (1), la cual puede recibir una definici√≥n de tipos cualesquiera
llamada Ts, la cual usa el nuevo TypeVarTuple (2). Como podemos ver, multiply devuelve estos mismos valores de
entrada (3), y add_dimension permite a√±adir un par√°metro adicional (4).</aside>
</section>
<section data-background-color="#000000" data-background-image="_static/confused.gif">
<aside class="notes">
Esto puede parecer complicado, porque es complicado. Es un caso poco utilizado que es √∫til en ciertas bibliotecas de
uso cient√≠fico y que pueden requerir de vectores.</aside>
</section>
<section  id="pep-655-typeddict-required-notrequired">
<h2><strong>PEP 655:</strong> TypedDict Required/NotRequired</h2>
<aside class="notes">
Seguimos con una novedad muy importante en TypedDict, de mis cosas favoritas en el tipado. La posibilidad de marcar
claves como no requeridas de forma m√°s f√°cil.</aside>
</section>
<section data-auto-animate>
<pre data-id="pep-655-typeddict-required-notrequired"><code data-trim data-noescape class="python" data-line-numbers="1-9|4"> from typing import TypedDict


 class Person(TypedDict, total=False):
     name: str  # Queremos que sea obligatorio pero no lo es
     surname: str  # Queremos que sea obligatorio pero no lo es
     age: int

 person: Person = {&quot;name&quot;: &quot;Juan&quot;, &quot;surname&quot;: &quot;Luna&quot;}</code></pre>
<aside class="notes">
Hasta ahora, la √∫nica forma de marcar claves como no requeridas era decir si la *totalidad* de las claves deben ser
requeridas, o ninguna era requerida. Pero no se pod√≠an marcar una por una como requerida o no. Para ello ten√≠amos el
total. (1)</aside>
</section>
<section data-auto-animate>
<pre data-id="pep-655-typeddict-required-notrequired"><code data-trim data-noescape class="python" data-line-numbers="4-10|4,9"> from typing import TypedDict


 class PersonRequired(TypedDict, total=True):
     name: str
     surname: str


 class Person(PersonRequired, total=False):
     age: int

 person: Person = {&quot;name&quot;: &quot;Juan&quot;, &quot;surname&quot;: &quot;Luna&quot;}</code></pre>
<aside class="notes">
Si quer√≠amos que una clave sea requerida pero otras no, hasta ahora la √∫nica manera era hacer dos clases distintas
(1), y definir en cada una de ellas si el total es True o False. (2)</aside>
</section>
<section data-auto-animate>
<pre data-id="pep-655-typeddict-required-notrequired"><code data-trim data-noescape class="python" data-line-numbers="1-10|7"> from typing import NotRequired, Required, TypedDict


 class Person(TypedDict):  # total=True por defecto
     name: str
     surname: str
     age: NotRequired[int]  # age no ser√° requerido por el NotRequired[]


 person: Person = {&quot;name&quot;: &quot;Juan&quot;, &quot;surname&quot;: &quot;Luna&quot;}</code></pre>
<aside class="notes">
Lo que trae nuevo este nuevo PEP con los nuevos Required y NotRequired, es que permiten definir claves requeridas o
no requeridas (1). En este caso todo es requerido salvo el age, que lo marcamos como no requerido.</aside>
</section>
<section data-transition="zoom">
<pre data-id="pep-655-typeddict-required-notrequired"><code data-trim data-noescape class="python" data-line-numbers="1-10|4|5-6"> from typing import NotRequired, Required, TypedDict


 class Person(TypedDict, total=False):
     name: Required[str]
     surname: Required[str]
     age: int


 person: Person = {&quot;name&quot;: &quot;Juan&quot;, &quot;surname&quot;: &quot;Luna&quot;}</code></pre>
<aside class="notes">
Tambi√©n podemos hacerlo al rev√©s (1), marcando todo como como no requerido con el total False (2), y marcar uno por
uno como requerido.</aside>
</section>
<section data-background-color="#000000" data-background-image="_static/thumb.gif">
<aside class="notes">
Como veis, ahora es mucho m√°s f√°cil y requiere escribir menos c√≥digo. Y tener que escribir menos c√≥digo siempre es
bien.</aside>
</section>
<section  id="pep-673-tipo-self">
<h2><strong>PEP 673:</strong> Tipo Self</h2>
<aside class="notes">
Self nos sirve para a√±adir de forma sencilla la forma de anotar que un m√©todo devuelve una instancia de la misma
clase. Antes pod√≠amos hacer un apa√±o con los generics, pero esta forma es m√°s sencilla y encima evitamos problemas
de dependencias circulares.</aside>
</section>
<section >
<pre data-id="pep-673-tipo-self"><code data-trim data-noescape class="python" data-line-numbers="10-11"> from typing import Self


 class Customer:

     def __init__(self, name: str, age: int):
         self.name = name
         self.age = age

     def __copy__(self) -&gt; Self:
         return self.__class__(self.name, self.age)</code></pre>
<aside class="notes">
En este ejemplo tenemos un m√©todo copy que devuelve una nueva instancia de Customer. En vez de usar gen√©ricos o
decir que se devuelve la misma clase, podemos usar el nuevo Self. Mucho m√°s sencillo.</aside>
</section>
<section>
<section  id="pep-675-literalstring">
<h2><strong>PEP 675:</strong> LiteralString</h2>
<aside class="notes">
El nuevo tipo LiteralString est√° hecho pensando en la seguridad, para evitar fallos de seguridad como un SQL
Injection.</aside>
</section>
<section >
<pre data-id="pep-675-literalstring"><code data-trim data-noescape class="python" data-line-numbers="1-11|8|11"> from typing import LiteralString, Iterable, Any


 def execute(sql: LiteralString, *params: Iterable[Any]):
     ...

# Esta l√≠nea validar√°, porque pasamos los par√°metros de forma segura
execute(&quot;SELECT * FROM data WHERE user_id = ?&quot;, [123])

# Esta l√≠nea dar√° error, porque se modifica el string de entrada previamente
execute(f&quot;SELECT * FROM data WHERE user_id = {user_id}&quot;)  # MEEH! Error.</code></pre>
<aside class="notes">
Usando LiteralString, el string de entrada tendr√° que venir sin manipular tal y como viene en el c√≥digo
fuente (1). En el primer ejemplo validar√° porque no se modifica (2), pero en el segundo al haber una manipulaci√≥n,
al no venir tal cual est√° en el c√≥digo fuente, dar√° un error en el tipado. Como veis este √∫ltimo caso ser√≠a un SQL
Injection de manual.</aside>
</section>
<section data-background-color="#000000" data-background-image="_static/security.gif" id="mas-seguridad">
<h3>M√°s seguridad</h3>
<aside class="notes">
Como veis, con los tipos no s√≥lo pod√©is evitar problemas de programaci√≥n t√≠picos, sino tambi√©n evitar fallos de
seguridad en vuestras aplicaciones.</aside>
</section>
</section>
<section  id="pep-681-data-class-transforms">
<h2><strong>PEP 681:</strong> Data Class Transforms</h2>
<aside class="notes">
PEP 681. Este PEP es interesante para los creadores de frameworks y bibliotecas, como pueden ser Django, Pydantic o
SQLAlchemy.</aside>
</section>
<section >
<pre data-id="pep-681-data-class-transforms"><code data-trim data-noescape class="python"># La clase ``ModelBase`` est√° definida en la biblioteca.
&#64;typing.dataclass_transform()
class ModelBase: ...


# La clase ``ModelBase`` puede ser usado para crear nuevos modelos,
# similar a como se hace en estos frameworks.
class CustomerModel(ModelBase):
    id: int</code></pre>
<aside class="notes">
Estas bibliotecas han creado sus propias clases para crear modelos, similares a los dataclass de Python. Ahora
tienen una forma de definir un tipado para sus clases base, para indicar que √©stas se comportar√°n como un dataclass
de Python.</aside>
</section>
<section >
<pre data-id="pep-681-data-class-transforms"><code data-trim data-noescape class="python">def dataclass_transform(
    *,
    eq_default: bool = True,
    order_default: bool = False,
    kw_only_default: bool = False,
    field_specifiers: tuple[type | Callable[..., Any], ...] = (),
    **kwargs: Any,
) -&gt; Callable[[_T], _T]: ...</code></pre>
<aside class="notes">
Por defecto el nuevo tipo se comportar√° como un dataclass al ser identificado, aunque usando la funci√≥n
dataclass_transform pueden cambiarse las opciones por defecto hacer la transformaci√≥n. En conclusi√≥n, este tipado es
√∫til si se est√° creando un modelo de clases similares a los dataclass.</aside>
</section>
<section  id="que-otras-novedades-hay">
<h2>¬øQu√© otras novedades hay?</h2>
<ul class="simple">
<li class="fragment"><p>Nuevo argumento <code class="docutils literal notranslate"><span class="pre">-P</span></code> en la l√≠nea de comandos y variable de entorno <code class="docutils literal notranslate"><span class="pre">PYTHONSAFEPATH</span></code> para
<strong>evitar ejecutar c√≥digo inseguro</strong>.</p></li>
<li class="fragment"><p><strong>PEP 594</strong>: Eliminar m√≥dulos muertos de la librer√≠a est√°ndar (deprecated, a eliminar en 3.13).</p></li>
<li class="fragment"><p><strong>PEP 624</strong>: Eliminadas las APIs de codificaci√≥n de Py_UNICODE.</p></li>
<li class="fragment"><p><strong>PEP 670</strong>: Convertir macros a funciones en la API en C de Python.</p></li>
<li class="fragment"><p><strong>¬°Y es m√°s r√°pido!</strong> (10-60% respecto Python 3.10).</p></li>
</ul>
<aside class="notes">
¬øY qu√© otras novedades hay? Tenemos... (leer puntos).</aside>
</section>
<section  id="mas-informacion">
<h2>M√°s informaci√≥n</h2>
<p><a class="reference external" href="https://docs.python.org/3.11/whatsnew/3.11.html">https://docs.python.org/3.11/whatsnew/3.11.html</a></p>
<aside class="notes">
En la web oficial de Python pod√©is encontrar el detalle sobre todas estas novedades. Pod√©is o bien copiar esta URL,
o buscarlo en Google y os saldr√° de lo primero.</aside>
</section>
<section>
<section data-transition="convex" id="como-puedo-conseguirlo">
<h2>¬øC√≥mo puedo conseguirlo?</h2>
<p class="fragment"><strong>¬°¬°Ya disponible!!</strong></p>
<aside class="notes">
¬øY c√≥mo puedes conseguirlo? Pues bien, ¬°ya est√° disponible! Python 3.11 sali√≥ literalmente hace dos d√≠as. Pod√©is
bajarlo desde la web de Python, desde vuestra distribuci√≥n si ya lo tuviese o compil√°ndolo desde los fuentes.</aside>
</section>
<section  id="desde-los-fuentes">
<h3>¬øDesde los fuentes?</h3>
<p><a class="reference external" href="https://www.build-python-from-source.com/">https://www.build-python-from-source.com/</a></p>
<aside class="notes">
Si quer√©is compilarlo desde los fuentes en esta web dispon√©is de una ayuda sobre c√≥mo hacerlo. No hace falta tener
grandes conocimientos t√©cnicos.</aside>
</section>
<section data-background-color="#ffffff" data-background-size="contain" data-background-image="_static/sam.png" data-transition="zoom" id="python-te-necesita">
<h3>Python te necesita</h3>
<aside class="notes">
Y recordad, que pod√©is ir probando las nuevas versiones de Python antes de su fecha de lanzamiento oficial. Tras la
primera beta no suele haber importantes cambios y prob√°ndolas y d√°ndoles soporte permit√≠s encontrar fallos en el
int√©rprete antes de su d√≠a de salida. Os animo encarecidamente a hacerlo.</aside>
</section>
</section>
<section>
<section  id="muchas-gracias">
<h2>¬°Muchas gracias!</h2>
<p class="fragment"><strong>Referencias</strong></p>
<ul class="simple">
<li class="fragment"><p><a class="reference external" href="https://docs.python.org/3.11/whatsnew/3.11.html">Qu√© hay de nuevo en Python 3.11 (doc oficial)</a>.</p></li>
<li class="fragment"><p><a class="reference external" href="https://realpython.com/python311-exception-groups/">Preview exception groups (Real Python)</a>.</p></li>
<li class="fragment"><p><a class="reference external" href="https://www.youtube.com/watch?v=hAj3nGzeSiQ">Python variadic generics (Anthony Explains)</a>.</p></li>
</ul>
<aside class="notes">
Y hasta aqu√≠ la presentaci√≥n. Os agradezco a todos por venir, y aqu√≠ os dejo algunas referencias utilizadas en
esta presentaci√≥n.</aside>
</section>
<section data-transition="zoom" id="y-la-presentacion">
<h3>¬øY la presentaci√≥n?</h3>
<p><a class="reference external" href="https://github.com/Nekmo/python311-presentacion">github:Nekmo/python311-presentacion</a></p>
<aside class="notes">
Adem√°s de la presentaci√≥n, por si quer√©is volver a verla.</aside>
</section>
<section data-background-color="#ffffff" data-background-size="contain" data-background-image="_static/qr.png">
<aside class="notes">
Adem√°s aqu√≠ la ten√©is en forma de QR por si os es m√°s c√≥modo, para no tener ni que escribir.</aside>
</section>
<section  id="contactar">
<h3>Contactar</h3>
<ul class="simple">
<li><p><strong>Sitio web:</strong> <a class="reference external" href="https://nekmo.com">nekmo.com</a></p></li>
<li><p><strong>Email:</strong> <a class="reference external" href="mailto:contacto&#37;&#52;&#48;nekmo&#46;com">contacto<span>&#64;</span>nekmo<span>&#46;</span>com</a></p></li>
<li><p><strong>Twitter:</strong> <a class="reference external" href="https://twitter.com/nekmocom">&#64;nekmocom</a></p></li>
<li><p><strong>Telegram:</strong> <a class="reference external" href="https://t.me/nekmo">&#64;nekmo</a></p></li>
<li><p><strong>Jabber:</strong> <a class="reference external" href="xmpp://nekmo&#64;nekmo.org">nekmo&#64;nekmo.org</a></p></li>
</ul>
<aside class="notes">
Finalmente, tambi√©n ten√©is mi sitio web (ejem ejem spam) en esta diapositiva. Adem√°s de mi email. Y Twitter.
Aunque apenas escriba en Twitter. Y ante todo, ¬°muchas gracias a todos! ¬øAlguna pregunta?</aside>
</section>
</section>

        </div>
    </div>
    
    <script src="_static/revealjs4/dist/reveal.js"></script>
    
    
      <script src="_static/revealjs4/plugin/notes/notes.js"></script>
      <script src="_static/revealjs4/plugin/highlight/highlight.js"></script>
      
    
    <script>
        var revealjsConfig = new Object();
        Object.assign(revealjsConfig, 
    {
        controls: true,
        progress: true,
        history: true,
        center: true,
        margin: 0.2,        
        transition: "slide",
    }
);
        
        
        
          revealjsConfig.plugins = [
            RevealNotes,RevealHighlight,
          ];
        
        // More info https://github.com/hakimel/reveal.js#configuration
        Reveal.initialize(revealjsConfig);
    </script>

  </body>
</html>